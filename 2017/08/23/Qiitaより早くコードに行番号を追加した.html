<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=UTF-8" http-equiv="content-type"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="format-detection" content="telephone=no"/>

    <title>Qiitaより早くコードに行番号を追加した - lilyum ensemble</title>
    <meta itemprop="name" content="Qiitaより早くコードに行番号を追加した - lilyum ensemble"/>
    <meta name="keywords" content="雑感,jekyll"/>
    <meta name="thumbnail" content="https://nymphium.github.io/pictures/github_icon.png"/>
    <meta itemprop="image" content="https://nymphium.github.io/pictures/github_icon.png"/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="lilyum ensemble"/>
    <meta name="twitter:title" content="Qiitaより早くコードに行番号を追加した - lilyum ensemble"/>
    <meta name="twitter:url" content="https://nymphium.github.io/2017/08/23/Qiita%E3%82%88%E3%82%8A%E6%97%A9%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E8%A1%8C%E7%95%AA%E5%8F%B7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F.html"/> 
    <meta name="twitter:text:description" content="こんにちは､びしょ〜じょです｡明日は院試です｡内容はタイトルの通り1｡Markdownでコードブロックといえば```で囲んで色々やると､エンジンがexample&lt;code&gt;    &..."/>
    <meta name="twitter:image:src" content="https://nymphium.github.io/pictures/github_icon.png"/>

    <link rel="icon" type="image/x-icon" href="/favicon.ico"/>
    <link rel="stylesheet" href="/css/main.css"/>
    <link rel="alternate" type="application/rss+xml" title="lilyum ensemble" href="https://nymphium.github.io/feed.xml"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa:300%7CDroid+Sans+Mono%7CCrimson+Text:400,400i" rel="stylesheet"/>
<!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Qiitaより早くコードに行番号を追加した" />
<meta name="author" content="Satoru Kawahara" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="こんにちは､びしょ〜じょです｡ 明日は院試です｡内容はタイトルの通り1｡ 要望も出ている ↩" />
<meta property="og:description" content="こんにちは､びしょ〜じょです｡ 明日は院試です｡内容はタイトルの通り1｡ 要望も出ている ↩" />
<link rel="canonical" href="https://nymphium.github.io/2017/08/23/Qiita%E3%82%88%E3%82%8A%E6%97%A9%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E8%A1%8C%E7%95%AA%E5%8F%B7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F.html" />
<meta property="og:url" content="https://nymphium.github.io/2017/08/23/Qiita%E3%82%88%E3%82%8A%E6%97%A9%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E8%A1%8C%E7%95%AA%E5%8F%B7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F.html" />
<meta property="og:site_name" content="lilyum ensemble" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2017-08-23T00:00:00+09:00" />
<script type="application/ld+json">
{"dateModified":"2017-08-23T00:00:00+09:00","datePublished":"2017-08-23T00:00:00+09:00","description":"こんにちは､びしょ〜じょです｡ 明日は院試です｡内容はタイトルの通り1｡ 要望も出ている ↩","author":{"@type":"Person","name":"Satoru Kawahara"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nymphium.github.io/2017/08/23/Qiita%E3%82%88%E3%82%8A%E6%97%A9%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E8%A1%8C%E7%95%AA%E5%8F%B7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F.html"},"@type":"BlogPosting","url":"https://nymphium.github.io/2017/08/23/Qiita%E3%82%88%E3%82%8A%E6%97%A9%E3%81%8F%E3%82%B3%E3%83%BC%E3%83%89%E3%81%AB%E8%A1%8C%E7%95%AA%E5%8F%B7%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%97%E3%81%9F.html","headline":"Qiitaより早くコードに行番号を追加した","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta property="og:image" content="https://nymphium.github.io/pictures/github_icon.png"/>
  </head>

  <body>
    <header class="site-header">
      <div class="wrapper" style="font-family: 'Comfortaa';">
        <a class="site-title" href="/">lilyum ensemble</a>
        <nav class="site-nav">
          <div class="trigger">
            <a class="page-link" href="/aboutme.html">About</a>
            <a class="page-link" href="/slide.html">Slides</a>
            <a class="page-link" href="/tags.html">Tags</a>
          </div>
        </nav>
      </div>
    </header>

    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
          <header class="post-header">
            <h1 class="post-title" itemprop="name headline">Qiitaより早くコードに行番号を追加した</h1>
            <span class="post-meta">
              <time datetime="2017-08-23T00:00:00+09:00" itemprop="datePublished">Aug 23, 2017</time>
              <p class="tags">tag: {<a href="/tags.html#%E9%9B%91%E6%84%9F-ref">雑感</a>, <a href="/tags.html#jekyll-ref">jekyll</a>}</p>
              <a class="twitter-share-button" href="https://twitter.com/intent/tweet" target="_blank" rel="noopener noreferrer">Tweet</a>
            </span>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            <script type="text/javascript" src="/js/GithubRepoWidget.min.js"></script>
            <script type="text/javascript">setTimeout(GithubRepoWidget.init, 3000);</script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">
            <!-- The loading of KaTeX is deferred to speed up page rendering -->
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.js" integrity="sha384-U8Vrjwb8fuHMt6ewaCy8uqeUXv4oitYACKdB0VziCerzt011iQ/0TqlSlv8MReCm" crossorigin="anonymous"></script>
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/contrib/auto-render.min.js" integrity="sha384-aGfk5kvhIq5x1x5YdvCp4upKZYnA8ckafviDpmWEKp4afOZEqOli7gqSnh8I6enH" crossorigin="anonymous"></script>
            <script>document.addEventListener("DOMContentLoaded", function(){
                    renderMathInElement(document.body,
                            { delimiters: [ {left: "$$",    right: "$$",    display: true}
                                          , {left: "\\(",   right: "\\)",   display: false}
                                          , {left: "\\[",   right: "\\]",   display: true}
                                          , {left: "[[",    right: "]]",    display: true}
                                          , {left: "$",     right: "$",     display: false}
                            ]
                            , })});</script>
          </header>
          <div class="post-content" itemprop="articleBody">
<p>こんにちは､びしょ〜じょです｡
明日は院試です｡内容はタイトルの通り<sup id="fnref1" title="要望も出ている "><a href="#fn1" rel="footnote">1</a></sup>｡</p>
<hr>
<p>Markdownでコードブロックといえば<code>```</code>で囲んで色々やると､エンジンが</p>
<div class="highlight">
<span class="listing-name">example</span><pre><code class="language-html" data-lang="html"><span class="nt">&lt;code&gt;</span>
    <span class="nt">&lt;span&gt;</span>...<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span&gt;</span>...<span class="nt">&lt;/span&gt;</span>
    ......
<span class="nt">&lt;/code&gt;</span>
</code></pre>
</div>
<p>みたいなものを履いてくれると予想する｡そしてこれはCSSのカウンターと:beforeなどで簡単に行番号が付けられると予想する｡</p>
<p>残念ながらRedcarpetではそうならないようだ｡</p>
<div class="highlight">
<span class="listing-name">HTMLified example</span><pre><code class="language-html" data-lang="html"><span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>code<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>...<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>...<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    ......
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/code<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
</code></pre>
</div>
<p>ではどうするか｡パワーで解決｡
Rubyプラグインを書いた｡ <a href="https://github.com/Nymphium/nymphium.github.io/blob/2e0d1161fae61d12895751eb1930d7b939afe618/_plugins/ordered/md_filters/09-lineno.rb" target="_blank" rel="noopener noreferrer">_plugins/ordered_md_filters/09-lineno.rb</a></p>
<p>markdownファイルを1行ずつ見ていって､<code>&lt;!--linenumber--&gt;</code>というコメントがあったらその直後のコードブロックに行番号をつける､というもの｡
対象コードブロックを配列に突っ込んでいき､行数を<code>&lt;pre&gt;</code>に突っ込んでいき､<code>&lt;div&gt;</code>で囲んで<code>float: left</code>で完成や､という非常に原始的な作りになっている｡</p>
<div class="codeline with_caption"><pre>1
2
3
4
5</pre></div>
<div class="highlight">
<span class="listing-name">linenumbered example</span><pre><code class="language-html" data-lang="html"><span class="nt">&lt;code&gt;</span>
    <span class="nt">&lt;span&gt;</span>...<span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span&gt;</span>...<span class="nt">&lt;/span&gt;</span>
    ......
<span class="nt">&lt;/code&gt;</span>
</code></pre>
</div>
<div class="highlight">
<span class="listing-name">HTMLified linenumbered example</span><pre><code class="language-html" data-lang="html"><span class="c">&lt;!-- どうやらRedcarpetはcode block内でもdivタグを認識してくれてしまうのでヤバイ--&gt;</span>
<span class="nt">&lt;</span><span class="err">(</span><span class="na">div</span><span class="err">)</span> <span class="na">class=</span><span class="s">"codeline with_caption"</span><span class="nt">&gt;&lt;pre&gt;</span>1
2
3
4
5<span class="nt">&lt;/pre&gt;&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"highlight"</span><span class="nt">&gt;</span>
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"listing-name"</span><span class="nt">&gt;</span>linenumbered example<span class="nt">&lt;/span&gt;&lt;pre&gt;&lt;code</span> <span class="na">class=</span><span class="s">"language-html"</span> <span class="na">data-lang=</span><span class="s">"html"</span><span class="nt">&gt;&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>code<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>...<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>...<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/span<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
    ......
<span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"nt"</span><span class="nt">&gt;</span><span class="ni">&amp;lt;</span>/code<span class="ni">&amp;gt;</span><span class="nt">&lt;/span&gt;</span>
<span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
<span class="nt">&lt;</span><span class="err">(/</span><span class="na">div</span><span class="err">)</span><span class="nt">&gt;</span>
</code></pre>
</div>
<p>最初の行数を変更したいというお客様のニーズにもお答え致しました｡
<code>&lt;!--linenumber:N--&gt;</code>で<em>N+1</em>行目から行番号が振られていく｡</p>
<div class="codeline"><pre>14
15
16
17
18
19
20
21</pre></div>
<div class="highlight"><pre><code class="language-" data-lang="">a
b
c
d
e
f
g
h
</code></pre></div>
<p>タイトルの通り<strong><em>Qiitaより早く</em></strong>コードブロックに行番号をつける機能を実装しました!!!! 快挙ですね｡
CSSいじるほうが時間かかりました｡
デザインに自信なしなのでイラッとした人などはprください｡
明日は院試です｡おわり｡</p>
<div class="footnotes">
<hr>
<ol>

<li id="fn1">
<p><a href="http://qiita.com/7of9/items/e65f2f36c817ab965284" target="_blank" rel="noopener noreferrer">要望</a>も出ている <a href="#fnref1" rev="footnote">↩</a></p>
</li>

</ol>
</div>
          </div>
        </article>

      </div>
    </div>
    <footer>
      <div class="pagination btn-group" style="text-align: center; font-family: 'Comfortaa';">
        <a class="btn prev" href="/2017/06/18/qiita-listing-name.html" title="Qiitaっぽいlistingのcaption">← Prev</a>
        /<a class="btn" href="/">Top</a>/
        <a class="btn next" href="/2017/09/14/%E9%99%A2%E8%A9%A6.html" title="キラキラ受験記">Next →</a>
      </div>
    </footer>

  </body>
</html>
