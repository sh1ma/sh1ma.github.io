<!DOCTYPE html>
<html>
  <head>
    <meta content="text/html;charset=UTF-8" http-equiv="content-type"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="format-detection" content="telephone=no"/>

    <title>うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡ - lilyum ensemble</title>
    <meta itemprop="name" content="うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡ - lilyum ensemble"/>
    <meta name="keywords" content="Kindle,雑感"/>
    <meta name="thumbnail" content="https://nymphium.github.io/pictures/github_icon.png"/>
    <meta itemprop="image" content="https://nymphium.github.io/pictures/github_icon.png"/>

    <meta name="twitter:card" content="summary"/>
    <meta name="twitter:site" content="lilyum ensemble"/>
    <meta name="twitter:title" content="うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡ - lilyum ensemble"/>
    <meta name="twitter:url" content="https://nymphium.github.io/2016/07/21/kindle_font.html"/> 
    <meta name="twitter:text:description" content="はじめにKindleの最安モデルがホコリをかぶっていたのですがなんとなくマウントしてみたところフォントの変更に成功した｡こんなんググればいっぱい出てくると思うので今更書くまでもない話ですが､体験..."/>
    <meta name="twitter:image:src" content="https://nymphium.github.io/pictures/github_icon.png"/>

    <link rel="icon" type="image/x-icon" href="/favicon.ico"/>
    <link rel="stylesheet" href="/css/main.css"/>
    <link rel="alternate" type="application/rss+xml" title="lilyum ensemble" href="https://nymphium.github.io/feed.xml"/>
    <link href="https://fonts.googleapis.com/css?family=Comfortaa:300%7CDroid+Sans+Mono%7CCrimson+Text:400,400i" rel="stylesheet"/>
<!-- Begin Jekyll SEO tag v2.5.0 -->
<meta name="generator" content="Jekyll v3.8.4" />
<meta property="og:title" content="うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡" />
<meta name="author" content="Satoru Kawahara" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="はじめに Kindleの最安モデルがホコリをかぶっていたのですがなんとなくマウントしてみたところフォントの変更に成功した｡ こんなんググればいっぱい出てくると思うので今更書くまでもない話ですが､体験として面白かったので書いておく｡" />
<meta property="og:description" content="はじめに Kindleの最安モデルがホコリをかぶっていたのですがなんとなくマウントしてみたところフォントの変更に成功した｡ こんなんググればいっぱい出てくると思うので今更書くまでもない話ですが､体験として面白かったので書いておく｡" />
<link rel="canonical" href="https://nymphium.github.io/2016/07/21/kindle_font.html" />
<meta property="og:url" content="https://nymphium.github.io/2016/07/21/kindle_font.html" />
<meta property="og:site_name" content="lilyum ensemble" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-07-21T00:00:00+09:00" />
<script type="application/ld+json">
{"description":"はじめに Kindleの最安モデルがホコリをかぶっていたのですがなんとなくマウントしてみたところフォントの変更に成功した｡ こんなんググればいっぱい出てくると思うので今更書くまでもない話ですが､体験として面白かったので書いておく｡","mainEntityOfPage":{"@type":"WebPage","@id":"https://nymphium.github.io/2016/07/21/kindle_font.html"},"author":{"@type":"Person","name":"Satoru Kawahara"},"@type":"BlogPosting","url":"https://nymphium.github.io/2016/07/21/kindle_font.html","headline":"うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡","dateModified":"2016-07-21T00:00:00+09:00","datePublished":"2016-07-21T00:00:00+09:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <meta property="og:image" content="https://nymphium.github.io/pictures/github_icon.png"/>
  </head>

  <body>
    <header class="site-header">
      <div class="wrapper" style="font-family: 'Comfortaa';">
        <a class="site-title" href="/">lilyum ensemble</a>
        <nav class="site-nav">
          <div class="trigger">
            <a class="page-link" href="/aboutme.html">About</a>
            <a class="page-link" href="/slide.html">Slides</a>
            <a class="page-link" href="/tags.html">Tags</a>
          </div>
        </nav>
      </div>
    </header>

    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
          <header class="post-header">
            <h1 class="post-title" itemprop="name headline">うわ〜ん変わっちゃった〜〜! kindleのフォントが変わっちゃった〜! どうか､しましたか? kindleのフォントが変わってしまったのですが…｡</h1>
            <span class="post-meta">
              <time datetime="2016-07-21T00:00:00+09:00" itemprop="datePublished">Jul 21, 2016</time>
              <p class="tags">tag: {<a href="/tags.html#Kindle-ref">Kindle</a>, <a href="/tags.html#%E9%9B%91%E6%84%9F-ref">雑感</a>}</p>
              <a class="twitter-share-button" href="https://twitter.com/intent/tweet" target="_blank" rel="noopener noreferrer">Tweet</a>
            </span>
            <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
            <script type="text/javascript" src="/js/GithubRepoWidget.min.js"></script>
            <script type="text/javascript">setTimeout(GithubRepoWidget.init, 3000);</script>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.css" integrity="sha384-9tPv11A+glH/on/wEu99NVwDPwkMQESOocs/ZGXPoIiLE8MU/qkqUcZ3zzL+6DuH" crossorigin="anonymous">
            <!-- The loading of KaTeX is deferred to speed up page rendering -->
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/katex.min.js" integrity="sha384-U8Vrjwb8fuHMt6ewaCy8uqeUXv4oitYACKdB0VziCerzt011iQ/0TqlSlv8MReCm" crossorigin="anonymous"></script>
            <script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0-beta/dist/contrib/auto-render.min.js" integrity="sha384-aGfk5kvhIq5x1x5YdvCp4upKZYnA8ckafviDpmWEKp4afOZEqOli7gqSnh8I6enH" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
          </header>
          <div class="post-content" itemprop="articleBody">
<h1 id="%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><a class="headerlink" href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB">はじめに</a></h1>
<p>Kindleの最安モデルがホコリをかぶっていたのですがなんとなくマウントしてみたところフォントの変更に成功した｡
こんなんググればいっぱい出てくると思うので今更書くまでもない話ですが､体験として面白かったので書いておく｡</p>
<h1 id="mount%2C+ls"><a class="headerlink" href="#mount%2C+ls">mount, ls</a></h1>
<p>USB接続すると､/dev/sdc1というものが生える｡
<code>lsblk -f</code>とすると､どうやらvfatのようだ｡マウントする｡<code>ls</code>を撃ち込むと､document､systemというディレクトリ､名前がハッシュのファイルなどがある｡</p>
<h1 id="%E6%80%AA%E3%81%97%E3%81%84system"><a class="headerlink" href="#%E6%80%AA%E3%81%97%E3%81%84system">怪しいsystem</a></h1>
<p>あきらかにsystemディレクトリに何かありそうだ｡<em>fonts</em>というディレクトリがぶら下がっており､フォントを変えたい気持ちが突然わいてきた｡</p>
<h1 id="fonts"><a class="headerlink" href="#fonts">fonts</a></h1>
<p>中を見ると､<em>ja.font</em>というファイルがある｡これやな｡</p>
<h1 id="cramfs%E3%82%84%E3%82%93%E3%81%91%E3%81%93%E3%82%8C"><a class="headerlink" href="#cramfs%E3%82%84%E3%82%93%E3%81%91%E3%81%93%E3%82%8C">cramfsやんけこれ</a></h1>
<p><code>xxd -g 1 ja.font | head</code>してみると<strong>45 3d cd 28</strong>というのが見える｡もちろん知らないのでググる｡Comressed ROMFSということが分かった｡
これもマウントしてみる｡
01-ja.confというfontconfigファイルとimage_manifestというフォント情報などが書かれたjsonファイルっぽいもの､ありましたねぇttfファイルが置かれているfontsディレクトリ｡</p>
<h1 id="read-only%E3%81%98%E3%82%83%E3%82%93%E3%83%8F%E3%82%B2%21+%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B"><a class="headerlink" href="#read-only%E3%81%98%E3%82%83%E3%82%93%E3%83%8F%E3%82%B2%21+%E3%82%B3%E3%83%94%E3%83%BC%E3%81%99%E3%82%8B">read-onlyじゃんハゲ! コピーする</a></h1>
<p>とのこと</p>
<h1 id="font%E3%82%92%E3%81%A4%E3%81%A3%E3%81%93%E3%82%80"><a class="headerlink" href="#font%E3%82%92%E3%81%A4%E3%81%A3%E3%81%93%E3%82%80">fontをつっこむ</a></h1>
<p>好きなフォントを突っ込もう!! ライセンスを無視するのは <img class="emoji" title=":no_good:" alt=":no_good:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f645.png" height="20" width="20"></p>
<p>JSONに書かれた情報を更新する｡<code>"FONTFILE.ttf.md5"</code>というパラメーターがあるので､<code>md5sum FONTFILE.ttf</code>で得た値を差し込む｡
<code>"fonts.ja"</code>には明朝体をローマ字で書く(のか?)｡<code>"font.MINCHOROMAN.display"</code>パラメーターにはUTF-8でフォント名を埋め込みたい｡
ここでLua5.3の<code>utf8</code>モジュールが役に立つわけですね! MoonScriptのリスト内包表記も便利だ!!</p>
<div class="highlight"><pre><code class="language-moon" data-lang="moon"><span class="nb">print</span><span class="w"> </span><span class="nb">table.concat</span><span class="w"> </span><span class="p">[</span><span class="s2">"\\u%x"</span><span class="o">\</span><span class="n">format</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">utf8</span><span class="p">.</span><span class="n">codes</span><span class="w"> </span><span class="s2">"FONT-NAME"</span><span class="p">]</span><span class="w">
</span></code></pre></div>
<h1 id="mkfs.cramfs"><a class="headerlink" href="#mkfs.cramfs">mkfs.cramfs</a></h1>
<p>コピーおよび変更したディレクトリをComressed ROMFSにもどす｡</p>
<h1 id="%E3%81%99%E3%81%A3%E3%81%A8%E3%81%99%E3%82%8B"><a class="headerlink" href="#%E3%81%99%E3%81%A3%E3%81%A8%E3%81%99%E3%82%8B">すっとする</a></h1>
<p>Comressed ROMFSに戻したイメージファイルをja.fontとしてスッと戻す</p>
<h1 id="umount%EF%BD%A4%E7%A2%BA%E8%AA%8D"><a class="headerlink" href="#umount%EF%BD%A4%E7%A2%BA%E8%AA%8D">umount､確認</a></h1>
<p>ええな</p>
<h1 id="%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB"><a class="headerlink" href="#%E3%81%8A%E3%82%8F%E3%82%8A%E3%81%AB">おわりに</a></h1>
<p>買ってすぐ(2015年1月あたり)にフォントの変更を試み､ググってみたりはしたものの結局フォントの変更に至らなかったので､今回はよくやったと思いました｡
<code>file</code>コマンドなどの使用をパッと思いつけばもう少し早くできましたね､反省してください｡</p>
          </div>
        </article>

      </div>
    </div>
    <footer>
      <div class="pagination btn-group" style="text-align: center; font-family: 'Comfortaa';">
        <a class="btn prev" href="/2016/06/26/RAID0%E3%81%AAF2FS%E3%81%ABArch%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB%E3%81%99%E3%82%8B.html" title="RAID0なF2FSにArchをインストールする">← Prev</a>
        /<a class="btn" href="/">Top</a>/
        <a class="btn next" href="/2016/09/07/yourname.html" title="『君の名は｡』考察">Next →</a>
      </div>
    </footer>

  </body>
</html>
